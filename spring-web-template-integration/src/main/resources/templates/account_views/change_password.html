<!DOCTYPE html>
<html lang="en">

<head th:replace="~{/fragments/head :: head}">
  <script>
    function validatePasswords(event) {
      var password = document.getElementById("password").value;
      var confirmPassword = document.getElementById("password_confirm").value;
      var errorMessage = document.getElementById("password-error");

      if (password !== confirmPassword) {
        errorMessage.textContent = "Passwords do not match!";
        errorMessage.style.display = "block";
        event.preventDefault(); // Prevent form submission
      } else {
        errorMessage.style.display = "none";
      }
    }
  </script>
</head>

<body>
  <header th:replace="~{/fragments/header :: header}"></header>

  <div class="login-container">
    <form class="login-form" th:action="@{/change-password}" th:object="${account}" method="post"
      onsubmit="validatePasswords(event)">
      <h2><strong>Change Password</strong></h2>

      <div th:if="${message ne null}" class="alert alert-success py-1 px-3 small shadow-sm rounded-2" role="alert">
        <i class="fa-solid fa-circle-check me-1"></i>
        <span th:text="${message}"></span>
      </div>

      <div class="form-group">
        <label for="password">Password</label>
        <div class="input-container">
          <input type="password" id="password" th:field="*{password}" name="password" placeholder="Enter your password"
            class="form-control" required />
          <div th:if="${#fields.hasErrors('password')}" class="text-danger small mt-1">
            <i class="fas fa-lock"></i>
          </div>
        </div>
      </div>

      <div class="form-group">
        <label for="password_confirm">Confirm Password</label>
        <div class="input-container">
          <input type="password" id="password_confirm" name="password_confirm" placeholder="Confirm your password"
            class="form-control" required />
          <i class="fas fa-lock"></i>
        </div>
        <div id="password-error" class="text-danger small mt-1" style="display: none;"></div>
      </div>


      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

      <button type="submit" class="login-btn">Update Password</button>
    </form>
  </div>

  <footer th:replace="~{/fragments/footer :: footer}"></footer>
</body>

</html>
